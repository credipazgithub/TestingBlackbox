<div class="app-telemedicina container-full text-center inner-page">
    <div class="row no-gutters align-items-center inner-title"></div>

    <div class="row no-gutters px-1 mt-1">
        <div class="col-12 msj-request text-center pt-0 mt-0">
            <div class="active-paycode d-none" style="margin-top:5px;display:inline;color:grey;font-weight:bold;">
                <table style="width:100%;">
                    <tr>
                        <td style="width:20%;"><div class="active-paycode text-center verification-code paycode"></div></td>
                        <td align="left" style="padding-left:3px;font-weight:normal;font-size:0.8rem;color:white;" class="paycode-message"></td>
                    </tr>
                </table>
                <div id="player_telemedicina" class="d-none" style="height:320px;width:100%;"></div>
            </div>
        </div>
        <div class="col-12 msj-status text-center pt-1 mt-2 d-none"></div>
        <div class="col-12 take-picture text-center pt-1 mt-2 d-none">
            <a href="#" data-action="camera" class="btn btn-primary btn-raised btn-block btn-take-picture" data-source="1">
                <i class="material-icons">add_a_photo</i> Sacar foto y enviarla al doctor
            </a>
        </div>
        <div class="col-12 msj-detalles text-left m-0 p-0 pt-1 mb-2" style="font-size:0.8rem;color:grey;font-weight:bold;">
            <p style="color:white;padding-bottom:10px;font-weight:bold;font-size:1.1em;" class="px-2 msgTelemedicina text-center"></p>
            <div class="inactive-paycode text-center generate-paycode" style="font-size:0.8rem;">
                <a href="#" class="btnTerminosConsentimiento model-by-id" data-id="95" data-accept="" data-reject="Cerrar" data-check="" style="color:cyan;">Términos y Condiciones</a>
            </div>
            <div class="mb-2 inactive-paycode text-center generate-paycode" style="font-size: 1rem; margin-top: 15px;">
                <a href="#" class='btn-generate-paycode text-center btn-solicitar'>Acepto términos y condiciones</a>
            </div>
            <div class="tel-closed text-center mb-2" style="font-size: 1rem; margin-top: 15px;">
                <a href="tel:08108881441" class='btn-call text-center btn-solicitar'>Acepto términos y condiciones</a>
            </div>
        </div>
        <!--
    <div class="col-12 active-paycode d-none text-center p-2">
        <button class="btnShowVideo btn btn-success">Mostrar la llamada activa</button>
    </div>
        -->
    </div>
    <div class="row no-gutters msj-credenciales p-1"></div>
</div>
<script>
    _NMF.onPageHeader(".inner-title", "TELEMEDICINA", "./img/MediYa/h_telemedicina.png", _NMF._default_page, false);
    _NMF.onResizeInner();
    $(".imgTitle").remove();
    $(".chevron").css({ "color": "white" });
    $(".dyn-title").css({ "color": "white" });
    $(".app-telemedicina").css({ "background-image": "url(./img/MediYa/telemedicina-no.png)", "background-size": "cover" });
    var _msg = "<p><b>En este momento su estado no le permite acceder a nuestros servicios.<br/>";
    _msg += "Por favor, comuníquese con Atención al Socio al 0810-666-1729.</b></p>";
    _msg += "<div class='row'><div class='col-12 mb-1 text-center px-0'><a href='tel:08106661729'><img src='./img/Mediya/boton_0810-2.png' style='width:70%;'/></a></div></div>";
    //_NMF._session_data.TeleMedicina = "N";
    if (_NMF._session_data.TeleMedicina == "N") {
        $(".btn-generate-paycode").remove();
        $(".btnTerminosConsentimiento").remove();
        $(".tel-closed").remove();
        if (parseInt(_NMF._session_data.IdSocio) != 0) {
            _msg = "<p>Su servicio está inhabilitado por falta de pago.  Puede recuperarlo abonando la deuda pendiente.</p>";
            _msg += "<a href='" + $(".linkPago").attr("href") +"' class='btn-pagar text-center btn-pagar' target='_blank'>Pagar</a>";
        }
        _msg = ("<i class='material-icons' style='font-size:72px;'>warning</i><br/>" + _msg);
    } else {
        $(".msj-credenciales").html($(".title-rCredencial").html());
        $(".msj-credenciales").append($(".rCredencial").html());
        if (!_NMF.onOpenTelemedicina()) {
            $(".btn-generate-paycode").remove();
            $(".app-telemedicina").css({ "background-image": "url(./img/MediYa/telemedicina-close.png)", "background-size": "cover" });
        } else {
            $(".tel-closed").remove();
        }
        _msg = "Servicio de videoconsulta con un médico clínico, que puede emitir una receta digital que se enviará a su teléfono.<br/>";
        _msg += _NMF._session_data.TelemedicinaMensajeCerrado + "<br/>";
        _msg += "Fuera de ese horario, comunicarse al 0810 888 1441.<br/>";
        _msg += "Posee tres consultas anuales sin cargo";
        if (_NMF._session_data.TeleMedicinaRegistrado == 2) {
            _msg += "<br/><b>Le recordamos que el envío de recetas y su descuento del 50% estará disponible a partir del mes próximo.</b>";
        }
    }
    $(".msgTelemedicina").html(_msg);

    try {
        var _x = _PHOTO;
    } catch (err) {
        $.getScript(("./js/PAY.js"), function () {
            $.getScript("./js/PHOTO.js", function () {
            });
        });
    }
    setTimeout(function () { $(".generate-paycode").show(); }, 50);

    var _videoServer = "https://localhost:44315/neovideo.v1/";
    var _authenticationServer = "https://localhost:44315/neoauthentication.v1/";

    //if (window.location.hostname != "localhost") {
    _videoServer = "https://api.gruponeodata.com/neovideo.v1/";
    _authenticationServer = "https://api.gruponeodata.com/neoauthentication.v1/";
    //}
    $("body").off("click", ".btnShowVideo").on("click", ".btnShowVideo", function () {
        $('[name ^= "jitsiConferenceFrame"]').css({ "height": _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.height, "width": _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.width });
        $(_NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.target).fadeIn("slow");
        $(".app-footer").addClass("d-none");
    });
    $.getScript("https://jvideo1.gruponeodata.com/external_api.js").done(function (script, textStatus) {
        $.getScript(_NMF._cdn_server + "authentication/NEOAUTHENTICATION.js?" + _TOOLS.UUID()).done(function (script, textStatus) {
            $.getScript(_NMF._cdn_server + "video/NEOVIDEO-jvideo1.js?" + _TOOLS.UUID()).done(function (script, textStatus) {
                $(_NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.target).html("");
                _NEOAUTHENTICATION._SERVER = _authenticationServer;
                _NEOVIDEO._SERVER = _videoServer;
                _NEOVIDEO._id_application = 6;
                _NEOVIDEO._username = "credipaz";
                _NEOVIDEO._password = "08.!Rcp#@80";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.target = "#meet";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.caller = "telemedicina-paciente";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.roomname = "NEOVIDEO";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.fullname = " ";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.alias = " ";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.width = "100vw";
                _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.height = "100vh";
                _NEOVIDEO._INTERFACE_CONFIG_OVERWRITE.TOOLBAR_BUTTONS = ['microphone', 'camera'];

                /*Defines behavior when close video*/
                _NEOVIDEO.onDisconnect = function () {
                    $(".app-footer").removeClass("d-none");
                    $("#meet").fadeOut("fast");
                    _NMF._joined = false;
                };
                _NEOVIDEO.onParticipantLeft = function (data) {
                    $(".app-footer").removeClass("d-none");
                    $("#meet").fadeOut("fast");
                    $(".close-sidebar").click()
                    _NMF._joined = false;
                };
                _NEOVIDEO.onParticipantJoined = function (data) {
                    $('[name ^= "jitsiConferenceFrame"]').css({ "height": _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.height, "width": _NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.width });
                    $(_NEOVIDEO._CONFIG_INIT_VIDEO_DEFAULTS.target).fadeIn("slow");
                    $(".app-footer").addClass("d-none");
                };

                _NEOVIDEO.onTurnOffVideo({});
                _NMF.onEvalCallStatus(null);
                clearInterval(_NMF._TIMER_STATUS);
                _NMF._TIMER_STATUS = setInterval(function () {
                    _NMF.onEvalCallStatus(null);
                }, 5000);
            });
        });
    });
</script>
